<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DynoCode</title>

  <!-- Monaco Editor -->
  <script src="https://unpkg.com/monaco-editor@0.45.0/min/vs/loader.js"></script>

  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="/static/responsive.css">
  <link rel="stylesheet" href="/static/resizer.css">
</head>

<body>
  <header class="topbar">
    <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>
    <div class="logo">ðŸš€ DynoCode</div>

    <nav class="nav">
      <a href="/dashboard" class="nav-link">ðŸ“Š Dashboard</a>
    </nav>
  </header>
  <div class="app">

    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <select id="sidebar-track-select" onchange="switchTrack(this.value)"
          style="width: 100%; border-radius: 6px; padding: 4px; background: var(--bg-hover); color: var(--text-primary); border: 1px solid var(--border); margin-right: 8px;">
          {% for id, title in all_tracks.items() %}
          <option value="{{ id }}" {% if id==current_track %}selected{% endif %}>{{ title }}</option>
          {% endfor %}
        </select>
        <button class="sidebar-toggle-btn" onclick="toggleDesktopSidebar()" title="Collapse Sidebar">â—€</button>
      </div>

      {% for group in sidebar %}
      <div class="day-group">
        <div class="day-title">{{ group.day }}</div>

        {% for p in group.problems %}
        <a href="/problem/{{ p.id }}" class="problem-link
              {% if p.id == problem.id %}active{% endif %}
              {% if p.id in solved %}solved{% endif %}
            ">
          {{ p.title }}
        </a>
        {% endfor %}
      </div>
      {% endfor %}
    </aside>
    <div class="resizer" id="resizer-sidebar"></div>

    <!-- MAIN -->
    <div class="main">

      <!-- HEADER -->
      <div class="header">
        <div style="display: flex; gap: 10px; align-items: center;">
          <button id="show-sidebar-btn" class="sidebar-show-btn" onclick="toggleDesktopSidebar()" title="Show Sidebar"
            style="display: none;">â–¶</button>
          <h2>{{ problem.title }}</h2>
        </div>

        <div class="header-actions">
          <button id="run-btn" onclick="runCode()">â–¶ Run</button>
          <button class="secondary" onclick="resetCode()">â†º Reset</button>
        </div>
      </div>

      <!-- CONTENT -->
      <div class="container">

        <!-- PROBLEM PANEL -->
        <div class="problem-panel">
          <div class="meta-row">
            <span class="badge badge-{{ problem.difficulty | lower }}">{{ problem.difficulty }}</span>
            <div class="tags">
              {% for tag in problem.tags %}
              <span class="tag">#{{ tag }}</span>
              {% endfor %}
            </div>
          </div>

          <p>{{ problem.description }}</p>

          <h4>Example</h4>
          <pre>Input: {{ problem.sample_input }}</pre>
          <pre>Output: {{ problem.sample_output }}</pre>

          {% if problem.hints %}
          <div class="hint-box">
            <details>
              <summary>Need a hint?</summary>
              <ul class="hint-list">
                {% for hint in problem.hints %}
                <li>{{ hint }}</li>
                {% endfor %}
              </ul>
            </details>
          </div>
          {% endif %}
        </div>
        <div class="resizer" id="resizer-panel"></div>

        <!-- EDITOR PANEL -->
        <div class="editor-panel">
          <div id="editor" class="editor"></div>
        </div>

      </div>
      <div class="resizer-h" id="resizer-output"></div>

      <!-- OUTPUT -->
      <div class="output-panel" id="output-panel">
        <div class="output-header" onclick="toggleOutputPanel()">
          <span class="output-title">ðŸ“‹ Output / Test Results</span>
          <span class="output-toggle-icon">â–¼</span>
        </div>
        <div class="output-content">
          <pre id="output">Ready to run.</pre>
        </div>
      </div>

    </div>
  </div>

  <script>
    const PROBLEM_ID = "{{ problem.id }}";
    const INITIAL_CODE = `{{ problem.function_signature | safe }}`;
  </script>

  <script src="/static/script.js"></script>

</body>

</html>